process.container = 'zatzmanm/scomatic'
docker.runOptions = '-u $(id -u):$(id -g)'


manifest {
    name            = 'scomatic'
    homePage        = 'https://github.com/mjz1/SComatic/tree/main'
    description     = 'Nextflow pipeline for running SComatic'
    defaultBranch   = 'main'
    mainScript      = 'scomatic.nf'
    version         = '1.0.0'
}

report {
    enabled = true
}

timeline {
    enabled = true
}

trace {
    enabled = false
}

dag {
    enabled = false
    file = 'pipeline_dag.html'
    overwrite = true
}




profiles {
    test {
        docker {
            enabled = true
        }

        params {
            scomatic = "/scomatic"
            outdir = "results"
            ref = "$projectDir/example_data/chr10.fa"
            bam = "$projectDir/example_data/Example.scrnaseq.bam"
            bai = "$projectDir/example_data/Example.scrnaseq.bam.bai"
            meta =  "$projectDir/example_data/Example.cell_barcode_annotations.tsv"
            sampleid = "Example"
        }
    }

    standard {
        docker {
            enabled = true
        }
    }

    juno {
        module = 'singularity/3.7.0'

        singularity {
            enabled = true
            autoMounts = true
        }

        process {
            executor = 'lsf'
            cpus = 8
            memory = '8 GB'
            time '24h'
            scratch = true
        }
    }
}
